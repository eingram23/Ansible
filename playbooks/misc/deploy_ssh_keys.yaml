# Run with ansible-playbook -kK

---
- name: Deploy Ansible keys to new host 
  hosts: "{{ hosts_prompt }}"
  gather_facts: no
  remote_user: eingram
  become: yes
  become_method: sudo

  vars_prompt:
    - name: "hosts_prompt"
      prompt: "Enter host/group to add new ssh keys to: "
      private: no
    - name: "pub_key"
      prompt: "Enter ssh pub key: "
      private: no
  
  tasks:
  
    - name: Create user .ssh dir
      file:
        path: "/home/eingram/.ssh"
        state: directory

    - name: Create authorized_keys if not already existing
      file:
        path: "/home/eingram/.ssh/authorized_keys"
        state: touch

    - name: Add public key
      lineinfile:
        path: "/home/eingram/.ssh/authorized_keys"
        line: "{{ pub_key }}"